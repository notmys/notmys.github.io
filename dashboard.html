<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard - utopia.wtf</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      display: flex;
      height: 100vh;
      font-family: 'Inter', sans-serif;
      background-color: #0f0f10;
      color: #e0e0e0;
      overflow: hidden;
    }
    #stars { position: fixed; width:100%; height:100%; z-index:0; pointer-events:none; }
    .star { position:absolute; width:2px; height:2px; background:white; opacity:0.3; animation:floatUp 5s linear infinite; }
    @keyframes floatUp {0%{transform:translateY(0);opacity:0;}10%{opacity:0.3;}90%{opacity:0.3;}100%{transform:translateY(-100vh);opacity:0;}}
    /* Sidebar (Material style) */
    #sidenav-main { position: fixed; top: 0; left: 0; height: 100%; width: 250px; background: linear-gradient(195deg, #1f2c34, #1a202c); padding: 20px; border-radius:12px; box-shadow:2px 0 10px rgba(0,191,255,0.2); z-index:1; overflow-y:auto; }
    #sidenav-main .sidenav-header { margin-bottom:20px; }
    #sidenav-main .navbar-brand { display:flex; align-items:center; justify-content:center; text-decoration:none; }
    #sidenav-main .material-icons { font-size:2rem; color:#0ff; margin-right:8px; }
    #sidenav-main ul { list-style:none; padding:0; }
    #sidenav-main li { margin:15px 0; }
    #sidenav-main a { display:flex; align-items:center; color:#aaa; text-decoration:none; font-weight:600; transition:color 0.3s; }
    #sidenav-main a .material-icons { margin-right:12px; }
    #sidenav-main a:hover { color:#0ff; }
    #sidenav-main a:hover .material-icons { color:#0ff; }
    /* Main Content */
    .content { flex:1; margin-left:270px; display:flex; flex-direction:column; align-items:center; padding:40px 20px; overflow-y:auto; position:relative; z-index:1; }
    .cards { display:grid; grid-template-columns:repeat(auto-fit, minmax(200px,1fr)); gap:20px; width:100%; max-width:1200px; margin-bottom:40px; }
    .card { background:#1e1e22; padding:30px; border-radius:12px; box-shadow:0 0 10px rgba(0,191,255,0.2); }
    .card h3 { margin-bottom:10px; color:#0ff; }
    .card p { color:#aaa; }
    /* Graph & Info Section */
    .graph-section { display:flex; align-items:flex-start; width:100%; margin-bottom:40px; justify-content:space-between; }
    .graph-container { flex:1; height:400px; }
    #execution-graph { width:100%; height:100%; }
    .info-card { width:280px; height:400px; margin-left:20px; background:#1e1e22; padding:20px; border-radius:12px; box-shadow:0 0 10px rgba(0,191,255,0.2); display:flex; flex-direction:column; justify-content:center; }
    .info-card h3 { color:#0ff; margin-bottom:20px; text-align:center; }
    .info-card p { margin-bottom:10px; color:#eee; font-size:0.95rem; }
    .info-card p span { color:#0ff; font-weight:600; }
  </style>
</head>
<body class="g-sidenav-show bg-gray-200 dark-version">
  <div id="stars"></div>
  <!-- Sidebar -->
  <aside id="sidenav-main">
    <div class="sidenav-header">
      <a href="https://utopia.voyage/" target="_blank" class="navbar-brand">
        <i class="material-icons">dashboard</i>
        <span style="color:white;font-size:1.25rem;">utopia.wtf</span>
      </a>
    </div>
    <hr class="horizontal light">
    <ul>
      <li><a href="#"><i class="material-icons">dashboard</i>Overview</a></li>
      <li><a href="#"><i class="material-icons">timeline</i>Executions</a></li>
      <li><a href="#"><i class="material-icons">people</i>Users</a></li>
      <li><a href="#"><i class="material-icons">security</i>Obfuscations</a></li>
      <li><a href="#"><i class="material-icons">settings</i>Settings</a></li>
      <li style="margin-top:30px;font-size:0.75rem;color:#777;text-transform:uppercase;">Account</li>
      <li><a href="#"><i class="material-icons">person</i>Profile</a></li>
      <li><a href="#"><i class="material-icons">login</i>Log out</a></li>
    </ul>
  </aside>
  <div class="content">
    <div class="cards">
      <div class="card"><h3>Total Executions</h3><p id="total-exec">--</p></div>
      <div class="card"><h3>Total Users</h3><p id="total-users">--</p></div>
      <div class="card"><h3>Monthly Obfuscations</h3><p id="monthly-obf">--</p></div>
      <div class="card"><h3>Threats Blocked</h3><p id="threats-blocked">--</p></div>
    </div>
    <div class="graph-section">
      <div class="graph-container"><canvas id="execution-graph"></canvas></div>
      <div class="info-card">
        <h3>Account Info</h3>
        <p>Email: <span id="user-email">--</span></p>
        <p>Discord: <span id="user-discord">--</span></p>
        <p>Uptime: <span id="user-uptime">--</span></p>
      </div>
    </div>
  </div>
  <script>
    function generateStars(count) {
      const stars = document.getElementById('stars');
      for (let i = 0; i < count; i++) {
        const s = document.createElement('div'); s.className = 'star';
        s.style.left = Math.random() * 100 + 'vw'; s.style.bottom = '-10px';
        s.style.animationDelay = Math.random() * 5 + 's'; stars.appendChild(s);
      }
    }
    async function fetchDashboardData() {
      const days = new Date().getDate(); const execs = [];
      for (let i = 0; i < days; i++) execs.push(Math.floor(Math.random() * 20));
      const totalExec = execs.reduce((a, b) => a + b, 0);
      // Read from localStorage
      const email = localStorage.getItem('discordEmail') || 'user@example.com';
      const discordRaw = localStorage.getItem('discordUser');
      let discordDisplay = 'Not connected';
      if (discordRaw) {
        try {
          const u = JSON.parse(discordRaw);
          discordDisplay = `${u.username}#${u.discriminator}`;
        } catch (e) {}
      }
      const uptime = localStorage.getItem('accountUptime') || '99.9%';
      return { execs, totalExec, totalUsers: 52, monthlyObf: 0, threatsBlocked: 0, email, discord: discordDisplay, uptime };
    }
    function generateDateLabels() {
      const labels = [];
      const today = new Date();
      const m = today.getMonth() + 1;
      const days = today.getDate();
      for (let i = 1; i <= days; i++) labels.push(`${m}/${i}`);
      return labels;
    }
    window.addEventListener('load', async () => {
      generateStars(100);
      const data = await fetchDashboardData();
      document.getElementById('total-exec').textContent = data.totalExec;
      document.getElementById('total-users').textContent = data.totalUsers;
      document.getElementById('monthly-obf').textContent = data.monthlyObf;
      document.getElementById('threats-blocked').textContent = data.threatsBlocked;
      document.getElementById('user-email').textContent = data.email;
      document.getElementById('user-discord').textContent = data.discord;
      document.getElementById('user-uptime').textContent = data.uptime;
      const ctx = document.getElementById('execution-graph').getContext('2d');
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: generateDateLabels(),
          datasets: [{ label: 'Executions per Day', data: data.execs, borderColor: '#00BFFF', backgroundColor: 'rgba(0,191,255,0.2)', fill: true, tension: 0.4, borderWidth: 2 }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            tooltip: { callbacks: { title(ctx) { return ctx[0].label; }, label(ctx) { return `Executions: ${ctx.raw}`; } } }
          },
          scales: { x: { title: { display: true, text: 'Date (MM/DD)' } }, y: { title: { display: true, text: 'Executions' }, beginAtZero: true } }
        }
      });
    });
  </script>
</body>
</html>
